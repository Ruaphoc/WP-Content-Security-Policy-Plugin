/*! wp-content-security-policy WP_CSP_Admin.js 2018-03-16 4:56:38 PM */

function WPCSPHandleLogAdmin(){jQuery(".WPCSPBlockedURLPath").each(function(e,t){var r=jQuery(this).closest("tr"),a=(jQuery(r).find(".WPCSPBlockedURLScheme").val(),jQuery(r).find(".WPCSPBlockedURLDomain").val()),d=jQuery(r).find(".WPCSPBlockedURLPath").val(),s=jQuery(r).find(".WPCSPBlockedURLFile").val();jQuery(r).find(".WPCSPBlockedURLPathError, .WPCSPBlockedURLFileError").html("").addClass("WPCSPHiddenEntry"),""==a&&""!=d&&(jQuery(r).find(".WPCSPBlockedURLPath").val(""),jQuery(r).find(".WPCSPBlockedURLPathError").html("Path setting needs a domain.").removeClass("WPCSPHiddenEntry")),""==a&&""!=s&&(jQuery(r).find(".WPCSPBlockedURLFile").val(""),jQuery(r).find(".WPCSPBlockedURLFileError").html("File setting needs a domain.").removeClass("WPCSPHiddenEntry")),""==d&&""!=s&&(jQuery(r).find(".WPCSPBlockedURLFile").val(""),jQuery(r).find(".WPCSPBlockedURLFileError").html("File setting needs a path.").removeClass("WPCSPHiddenEntry"))})}jQuery(document).ready(function(){WPCSPHandleLogAdmin(),jQuery("#wpcsp_tabsAdmin").tabs()}),jQuery(document).on("change",".WPCSPBlockedURLPath, .WPCSPBlockedURLFile",WPCSPHandleLogAdmin),jQuery(document).on("click",".btnWPCSPHideErrors",function(){var e=jQuery(this).closest("tr"),t=jQuery(this).data("target");jQuery(this).addClass("WPCSPHiddenEntry"),jQuery(".btnWPCSPViewErrors",e).removeClass("WPCSPHiddenEntry"),jQuery(t).addClass("WPCSPHiddenEntry")}),jQuery(document).on("click",".btnWPCSPConvertToV3",function(){jQuery(this);var e=jQuery(this).closest("tr"),t=jQuery(this).data("target");jQuery(e).find(".WPCSPInfoBox");if(jQuery(".WPCSPInfoBox:visible").css("display","none"),jQuery(this).hasClass("btnWPCSPConvertToV3")){var r="'unsafe-inline' https: 'strict-dynamic'";jQuery("#script-src").val(r),jQuery(t).html("script-src set to CSP v3 default values &quot;"+r+"&quot; - use the save button to save these changes")}}),jQuery(document).on("click",".btnWPCSPViewErrors, .btnWPCSPAddSafeDomain, .btnWPCSPIgnoreDomain",function(){var a=jQuery(this),d=jQuery(this).closest("tr"),s=jQuery(this).data("target"),e=jQuery(d).data("violateddirective"),n=jQuery(d).find(".WPCSPInfoBox"),i=!1,t={};jQuery(this).hasClass("btnWPCSPViewErrors")&&(t={subaction:"getdata",violateddirective:e,blockeduri:jQuery(d).data("blockeduri")},jQuery(this).addClass("WPCSPHiddenEntry"),jQuery(".btnWPCSPHideErrors",d).removeClass("WPCSPHiddenEntry")),jQuery(this).hasClass("btnWPCSPAddSafeDomain")&&(t={subaction:"addSafeDomain",violateddirective:e,scheme:jQuery(d).find(".WPCSPBlockedURLScheme").val(),domain:jQuery(d).find(".WPCSPBlockedURLDomain").val(),path:jQuery(d).find(".WPCSPBlockedURLPath").val(),file:jQuery(d).find(".WPCSPBlockedURLFile").val()},i=!0),jQuery(this).hasClass("btnWPCSPIgnoreDomain")&&(t={subaction:"addIgnoreDomain",violateddirective:e,scheme:jQuery(d).find(".WPCSPBlockedURLScheme").val(),domain:jQuery(d).find(".WPCSPBlockedURLDomain").val(),path:jQuery(d).find(".WPCSPBlockedURLPath").val(),file:jQuery(d).find(".WPCSPBlockedURLFile").val()},i=!0),jQuery(".WPCSPInfoBox:visible").css("display","none"),t._wpnonce=WPCSP.restAdminNonce,jQuery(a).fadeTo("slow",.3),jQuery.ajax({url:WPCSP.restAdminURL,data:t,dataType:"json",type:"POST",error:function(e,t,r){jQuery(a).fadeTo("fast",1),jQuery(n).html(t+": "+e.responseText+"<br>Please Retry.").css("display","block")},success:function(e){jQuery(a).fadeTo("fast",1);var t="";if(""!==e.html&&(t="<p>"+e.html+"</p>"),!0===e.success){var r="";jQuery.each(e.data,function(e,t){r+="<tr><td class='tdWPCSPReferrer'>"+t.document_uri+"</td><td class='tdWPCSPUserAgent'>"+t.useragent+"</td><td class='tdWPCSPNumErrors'>"+t.numerrors+"</td></tr>"}),""!=r&&(t+=r="<table><thead><tr><td class='tdWPCSPReferrer'>URL Affected</td><td class='tdWPCSPUserAgent'>UserAgent</td><td class='tdWPCSPNumErrors'>Count</td></tr></thead>"+r+"</tbody></table>"),jQuery("td",s).html(t),jQuery(s).removeClass("WPCSPHiddenEntry"),!0===i&&jQuery(d).addClass("WPCSPHiddenEntry")}else jQuery(n).html(t).css("display","block")}})}),jQuery(document).on("click",".btnWPCSPClearLogFile, .btnWPCSPTestURLChecker",function(){var a=jQuery(this);jQuery(this).hasClass("btnWPCSPClearLogFile")&&(data={subaction:"clearLogFile"},jQuery(this).closest("p")),jQuery(this).hasClass("btnWPCSPTestURLChecker")&&(data={subaction:"TestURLChecker"},jQuery(this).closest("tr"));var d=jQuery(this).data("target");jQuery(d).html("").addClass("WPCSPHiddenEntry"),void 0!==data&&(jQuery(a).fadeTo("slow",.3),data._wpnonce=WPCSP.restAdminNonce,jQuery.ajax({url:WPCSP.restAdminURL,data:data,dataType:"json",type:"POST",error:function(e,t,r){jQuery(a).fadeTo("fast",1),jQuery(d).html(t+": "+e.responseText+"<br>Please Retry.").removeClass("WPCSPHiddenEntry")},success:function(e){jQuery(a).fadeTo("fast",1);var t="";""!==e.html&&(t="<p>"+e.html+"</p>"),jQuery(d).html(t).removeClass("WPCSPHiddenEntry"),jQuery(".wpcsp-logoferrors").fadeTo("fast",0).html()}}))});